<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sequoia • Rsequoia2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sequoia">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Rsequoia2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/analysis_units.html">Analysis units</a></li>
    <li><a class="dropdown-item" href="../articles/cadastral-parcels-fr.html">Parcelles Cadastrales</a></li>
    <li><a class="dropdown-item" href="../articles/cadastral-parcels-legal-entity-fr.html">Parcelles cadastrales - Personne morale (FR)</a></li>
    <li><a class="dropdown-item" href="../articles/cadastral-parcels-legal-entity.html">Cadastral parcels - legal entity (FR)</a></li>
    <li><a class="dropdown-item" href="../articles/cadastral-parcels.html">Cadastral parcels</a></li>
    <li><a class="dropdown-item" href="../articles/sequoia-fr.html">Sequoia</a></li>
    <li><a class="dropdown-item" href="../articles/sequoia.html">Sequoia</a></li>
    <li><a class="dropdown-item" href="../articles/vecteurs.html">Téléchargement de données</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sequoia</h1>
            
      

      <div class="d-none name"><code>sequoia.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mucau.github.io/Rsequoia2/">Rsequoia2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Attempting to load the package cache ... No cache found.</span></span>
<span><span class="co">#&gt; Will try to reconfigure qgisprocess and build new cache ...</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-tmap/tmap" class="external-link">tmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://janmarvin.github.io/openxlsx2/" class="external-link">openxlsx2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.4.0; sf_use_s2() is TRUE</span></span></code></pre></div>
<div class="section level2">
<h2 id="what-is-sequoia">What is Sequoia<a class="anchor" aria-label="anchor" href="#what-is-sequoia"></a>
</h2>
<p>Sequoia is an opiniated way of dealing with forest management. It’s
goal is to :</p>
<ul>
<li>Facilitate downloading of data for forest management ;</li>
<li>Normalize data (name and structure) ;</li>
<li>Facilitate exploration of those data</li>
</ul>
</div>
<div class="section level2">
<h2 id="what-is-a-sequoia-process">What is a Sequoia process<a class="anchor" aria-label="anchor" href="#what-is-a-sequoia-process"></a>
</h2>
<p>Sequoia process always have those step :</p>
<ul>
<li>Setting a directory ;</li>
<li>Creating parca matrice (excel with cadastrals parcels info);</li>
<li>Downloading parca geometry;</li>
<li>Downloading data based on parca;</li>
<li>GIS part to create analysis units ;</li>
<li>Generating final layer from analysis units</li>
</ul>
<div class="section level3">
<h3 id="setting-a-directory">Setting a directory<a class="anchor" aria-label="anchor" href="#setting-a-directory"></a>
</h3>
<p>All <code>seq_*</code> function have <code>dirname = "."</code>
argument, meaning they use the current working directory by default.
Best practice is to create a dedicated directory and set it as the
working directory for the R session.</p>
<p>For the example, a forest named <code>"ECKMUHL"</code> is used:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sequoia_dir</span> <span class="op">&lt;-</span> <span class="st">"ECKMUHL"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">sequoia_dir</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># setting current dir to our sequoia dir</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="va">sequoia_dir</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="creating-parca-matrice">Creating parca matrice<a class="anchor" aria-label="anchor" href="#creating-parca-matrice"></a>
</h3>
<p><code>Rsequoia2</code> provides several ways to generate this
fundamental file:</p>
<ul>
<li>A manually filled Excel file (see Cadastral Parcels article)</li>
<li>Using legal-entity open data (see Cadastral Parcels - Legal Entity
article)</li>
<li>Generating the file from DGFiP PDF matrices</li>
</ul>
</div>
<div class="section level3">
<h3 id="downloading-parca-geometry">Downloading parca geometry<a class="anchor" aria-label="anchor" href="#downloading-parca-geometry"></a>
</h3>
<p>All data downloaded by <code>Rsequoia2</code> are based on cadastral
parcels (parca). The first mandatory step is therefore to download them
using <code><a href="../reference/seq_parca.html">seq_parca()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq_parca.html">seq_parca</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="downloading-data">Downloading data<a class="anchor" aria-label="anchor" href="#downloading-data"></a>
</h3>
<p><code>Rsequoia2</code> offer many datasets, which can be downloaded
using <code>seq_*</code> functions:</p>
<ul>
<li>Environnemental data from MNHN ;</li>
<li>Elevation data from IGN ;</li>
<li>Orthophoto data from IGN ;</li>
<li>Geological data from BRGM ;</li>
<li>Hydrological data from BD Topo IGN ;</li>
<li>Patrimony data from Atlas du Patrimoine ;</li>
<li>…</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq_mnhn.html">seq_mnhn</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analyst-unist">Analyst unist<a class="anchor" aria-label="anchor" href="#analyst-unist"></a>
</h3>
<p>The next step after downloading <strong>parca</strong> and the
additional datasets is to create the analysis units.</p>
<p>This layer is generated using <code><a href="../reference/seq_parca_to_ua.html">seq_parca_to_ua()</a></code>. Your
task is to segment the layer so that it reflects the actual forest
structure.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq_parca_to_ua.html">seq_parca_to_ua</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Additional layers can help with this step, but the real diagnostic
comes from field data collection.</p>
<p>For more details, see the Analysis units article.</p>
</div>
<div class="section level3">
<h3 id="finalizing-the-layer">Finalizing the layer<a class="anchor" aria-label="anchor" href="#finalizing-the-layer"></a>
</h3>
<p>The final step, after manually completing the UA layer, is to make
sure everything is correct (and, more importantly, that nothing was
accidently corrupted). Some additional processing is also required to
properly finalize this layer.</p>
<p><code><a href="../reference/seq_ua.html">seq_ua()</a></code> performs a series of checks and corrections to
validate and finalize the UA layer:</p>
<ul>
<li>Checks cadastral IDU consistency between UA and PARCA</li>
<li>Ensures UA cadastral areas match PARCA by correcting any detected
differences</li>
<li>Generates a standardized management unit identifier (UG) in the UA
object</li>
<li>Computes corrected cadastral areas for analysis units based on
cartographic area</li>
<li>Checks management unit (UG) consistency within the UA sf object</li>
<li>Detects and corrects minor inconsistencies within management units
(UG)</li>
<li>Cleans geometry topology</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq_ua.html">seq_ua</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>Last but not least, the final step is to generate tables that help
users better understand and write their forest management document.</p>
<p><code><a href="../reference/seq_summary.html">seq_summary()</a></code> produces a set of opinionated summary
tables derived from the UA layer.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/seq_summary.html">seq_summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="how-it-works">How it works<a class="anchor" aria-label="anchor" href="#how-it-works"></a>
</h2>
<div class="section level3">
<h3 id="internal-configuration">Internal configuration<a class="anchor" aria-label="anchor" href="#internal-configuration"></a>
</h3>
<p><code>Rsequoia2</code> relies on an internal configuration that maps
keys to data layers and their metadata. For example, the key
<code>"r.sol.geol"</code> refers to the geological raster layer named
<code>GEOL.tif</code>.</p>
<p>All available keys can be listed with <code><a href="../reference/seq_key.html">seq_key()</a></code>. To
access metadata for a specific layer, use
<code>seq_layer("r.sol.geol")</code>.</p>
<p>Note that full keys are not always required:
<code>seq_layer("geol")</code> also works.</p>
</div>
<div class="section level3">
<h3 id="seq_-functions">
<code>seq_*</code> functions<a class="anchor" aria-label="anchor" href="#seq_-functions"></a>
</h3>
<p>All main functions in <code>Rsequoia2</code> start with
<code>seq_*</code> (e.g. <code><a href="../reference/seq_geol.html">seq_geol()</a></code>,
<code><a href="../reference/seq_prsf.html">seq_prsf()</a></code>, …).</p>
<p>These functions: - Read the project cadastral parcels to defined area
of interest ; - Download the required data ; - Save them according to
the configuration (name and extension) ; - Return path(s) where the data
are stored.</p>
<p>Note: for advanced users, each <code>seq_*</code> function has an
equivalent <code>get_*</code> function (e.g. <code>get_geol()</code>,
<code><a href="../reference/get_prsf.html">get_prsf()</a></code>, …). These can be used independently of the
Sequoia workflow.</p>
</div>
<div class="section level3">
<h3 id="cheat-code">Cheat code !<a class="anchor" aria-label="anchor" href="#cheat-code"></a>
</h3>
<p>For those who made it to the end, <code>Rsequoia2</code> provides a
wrapper function to guide you through the entire workflow:
<code><a href="../reference/sequoia.html">sequoia()</a></code>.</p>
<p>Have fun !</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthieu Chevereau, Paul Carteron.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
